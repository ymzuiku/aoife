function I(...e){e.forEach(t=>{this.prototype.appendChild(t)})}typeof HTMLElement.prototype.append=="undefined"&&(Element.prototype.append=I);function R(){this.prototype.parentNode&&this.prototype.parentNode.removeChild(this)}typeof HTMLElement.prototype.remove=="undefined"&&(Element.prototype.remove=R);function w(){let e=this.parentNode,t=arguments.length,i;if(!!e)for(t||e.removeChild(this);t--;)i=arguments[t],typeof i!="object"?i=this.ownerDocument.createTextNode(i):i.parentNode&&i.parentNode.removeChild(i),t?e.insertBefore(i,this.nextSibling):e.replaceChild(i,this)}Element.prototype.replaceWith||(Element.prototype.replaceWith=w);CharacterData.prototype.replaceWith||(CharacterData.prototype.replaceWith=w);DocumentType.prototype.replaceWith||(DocumentType.prototype.replaceWith=w);var N={childList:!0,subtree:!0},m=new WeakMap,d=new WeakMap,h=new WeakMap;function v(e,t){if(m.has(e)){m.get(e).push(t);return}m.set(e,[t]);let i=new MutationObserver(n=>{if(document.contains(e)){i.disconnect();let o=m.get(e);o&&o.forEach(r=>r()),m.delete(e)}});i.observe(document,N)}function T(e,t){if(d.has(e)){d.get(e).push(t);return}d.set(e,[t]),v(e,()=>{let i=new MutationObserver(()=>{if(!document.contains(e)){i.disconnect();let n=d.get(e);n&&n.forEach(o=>o()),d.delete(e)}});i.observe(document,N)})}var _=(e,t,{minHeight:i="50px",root:n}={})=>{if(h.has(e)){h.get(e).push(t);return}h.set(e,[t]),v(e,()=>{if(e.style.minHeight||(e.style.minHeight=i),!e.getAttribute("data-lazy")){e.setAttribute("data-lazy","1");let o=new IntersectionObserver(r=>{r.forEach(s=>{if(e.setAttribute("data-lazy","2"),s.isIntersecting){o.disconnect();let a=h.get(e);a&&a.forEach(l=>l(s)),h.delete(e)}})},{root:n,rootMargin:window.innerHeight/2+"px"});o.observe(e),T(e,()=>{o.disconnect()})}})};var K=new Set;function S(e){let t=[];if(e)if(typeof e=="string"){let i="",n=e.split(", ");n.forEach((o,r)=>{o=o.trim(),r===n.length-1?i+=`${o}[aoife-next], ${o} [aoife-next]`:i+=`${o}[aoife-next], ${o} [aoife-next],`}),t=document.body.querySelectorAll(i)}else Object.prototype.toString.call(e)==="[object Array]"?(t=[...e],e.forEach(i=>{t.push(...i.querySelectorAll("*"))})):(t=[e],t.push(...e.querySelectorAll("*")));return t}var C=(e,t)=>{if(!e){console.error("aoife.next() need target");return}let i=S(t),n=S(e),o=n.length;for(let r=0;r<o;r++){let s=n[r];if(s.__next&&document.body.contains(s)){if(i.length){let a=i.length,l=!1;for(let c=0;c<a;c++){let p=i[c];if(p===s||p.contains(s)){l=!0;break}}if(l)continue}s.__next.forEach(a=>{a()})}}K.forEach(r=>r())},E=(e,t,i)=>{e.__next||(e.setAttribute("aoife-next",""),e.__next=new Map),e.__next.set(t,i)};var A={autofocus:!0,role:!0,viewBox:!0,flavor:!0};function M(e,t){return typeof t=="function"?Promise.resolve(t(e)):t}function H(e,t,i){let n=i[t];if(/^on/.test(t))return e[t]=n,null;if(/^listen/.test(t))return e.addEventListener(t.replace("listen",""),n),null;let o;return e.__isSvg||A[t]||/-/.test(t)?o=async()=>{let r=await M(e,n);e.getAttribute(t)!==r&&(r===!1?e.removeAttribute(t):e.setAttribute(t,r))}:t==="style"?o=async()=>{let r=await M(e,n);if(!!r){if(typeof r=="string"){e.style.cssText=r;return}Object.assign(e.style,r)}}:t==="className"?o=async()=>{let r=await M(e,n);typeof r!="string"&&(r=r.join(" ")),e.className!==r&&(e.className=r)}:o=async()=>{let r=await M(e,n);e[t]!==r&&(e[t]=r)},o(),typeof n!="function"?null:o}function b(e){let t=Object.prototype.toString.call(e);if(t==="[object String]"||t==="[object Number]")return!0}function x(e){return Object.prototype.toString.call(e).indexOf("lement")>0}function g(e,t){e.isEqualNode(t)||e.replaceWith(t)}function O(e,t){if(!Array.isArray(e))return;e.filter(n=>n!=null).forEach((n,o)=>{if(b(n)){let r=document.createTextNode(n);r.key=o,t.append(r)}else if(typeof n=="function"){let r=document.createTextNode("");t.append(r);let s=async()=>{let a=await Promise.resolve(n());if(b(a)){let l=document.createTextNode(a);l.key=o;let c=!1;return t.childNodes.forEach(p=>{if(p.key===l.key){if(p.textContent===l.textContent){c=!0;return}g(p,l),c=!0}}),c||t.insertBefore(l,r),o}else if(Array.isArray(a)){let l={},c={};a.forEach((f,y)=>{f.___forList=o,f.key||(f.key=`fn(${o})-list(${y})`),c[f.key]=f});let p=[];return t.childNodes.forEach(f=>{f.___forList===o&&(c[f.key]?l[f.key]=f:p.push(f))}),p.forEach(f=>{f.remove()}),a.forEach(f=>{let y=l[f.key];y?y.isEqualNode(f)||g(y,f):f!==!1&&t.insertBefore(f,r)}),"for-list-"+o}else if(a){a.key||(a.key=o);let l=!1;return t.childNodes.forEach(c=>{c.key===a.key&&(g(c,a),l=!0)}),l||t.insertBefore(a,r),a.key}};s(),E(t,"children",s)}else if(x(n))t.append(n);else if(n!==!1)if(Object.prototype.toString.call(n)==="[object Array]"){let r=[];for(let s=0;s<n.length;s++){let a=n[s];a!==!1&&r.push(a)}t.append(...r)}else t.appendChild(n)})}var L=[],F=e=>{L.push(e)};var W={svg:!0,rect:!0,circle:!0,ellipse:!0,line:!0,polyline:!0,polygon:!0,path:!0,animate:!0,animateColor:!0,animateMotion:!0,animateTransform:!0,clipPath:!0,"color-profile":!0,"definition-src":!0,defs:!0,desc:!0,filter:!0,font:!0,"font-face":!0,"font-face-format":!0,"font-face-name":!0,"font-face-src":!0,"font-face-uri":!0,g:!0,glyph:!0,hkern:!0,linearGradient:!0,marker:!0,mask:!0,view:!0};var j=e=>{let t=[];return e.forEach(i=>{Array.isArray(i)?t=t.concat(i):t.push(i)}),t};var P={class:1,className:1,onsubmit:1,onAppend:1,onRemove:1,onEntry:1,child:1,children:1,length:1},k=["className"],u=(e,t,...i)=>{let n={};if(t&&(typeof t=="function"||b(t)||x(t)?i=[t,...i]:Array.isArray(t)?i=[...t,...i]:n=t),i=j(i),(!n.children||!n.children.length)&&(n.children=[...i]),n.class&&(n.className=n.class,delete n.class),Array.isArray(e))return u(...e);let o;if(typeof e=="function"){if(o=e(n),o&&typeof o.then=="function"){let r=document.createElement("span");return r.setAttribute("promise-span",""),o.then(s=>{r.replaceWith(s)}),r}return o}if(typeof e=="string")if(e==="template"&&n.children){let r="";n.children.forEach(s=>{(typeof s=="string"||typeof s=="number")&&(r+=s)}),o=document.createElement("template"),o.innerHTML=r}else W[e]?(o=document.createElementNS("http://www.w3.org/2000/svg",e),o.__isSvg=!0):o=document.createElement(e);else x(e)&&(o=e);return n.onsubmit&&(o.onsubmit=r=>{r.preventDefault(),n.onsubmit&&n.onsubmit(r)}),k.forEach(r=>{if(n[r]){let s=H(o,r,n);s&&E(o,r,s)}}),Object.keys(n).forEach(r=>{if(P[r])return;let s=H(o,r,n);s&&E(o,r,s)}),O(n.children,o),typeof n.onAppend=="function"&&v(o,n.onAppend),typeof n.onRemove=="function"&&T(o,n.onRemove),typeof n.onEntry=="function"&&_(o,n.onEntry),L.length&&L.forEach(r=>{r(o,n)}),o},q=e=>e&&e.children?u("span",{style:{all:"unset"}},...e.children):"";u.jsxFrag=q;u.next=C;u.attributeKeys=A;u.useMiddleware=F;window.aoife=u;var D=u;export{D as default};
