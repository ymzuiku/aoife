var g={childList:!0,subtree:!0},m=new WeakMap,d=new WeakMap,E=new WeakMap;function T(e,s){if(m.has(e)){m.get(e).push(s);return}m.set(e,[s]);let i=new MutationObserver(n=>{if(document.contains(e)){i.disconnect();let t=m.get(e);t&&t.forEach(r=>r(e)),m.delete(e)}});i.observe(document,g)}function L(e,s){if(d.has(e)){d.get(e).push(s);return}d.set(e,[s]),T(e,()=>{let i=new MutationObserver(()=>{if(!document.contains(e)){i.disconnect();let n=d.get(e);n&&n.forEach(t=>t(e)),d.delete(e)}});i.observe(document,g)})}var k=(e,s,{minHeight:i="50px",root:n}={})=>{if(E.has(e)){E.get(e).push(s);return}E.set(e,[s]),T(e,()=>{if(e.style.minHeight||(e.style.minHeight=i),!e.getAttribute("data-lazy")){e.setAttribute("data-lazy","1");let t=new IntersectionObserver(r=>{r.forEach(a=>{if(e.setAttribute("data-lazy","2"),a.isIntersecting){t.disconnect();let o=E.get(e);o&&o.forEach(l=>l(a)),E.delete(e)}})},{root:n,rootMargin:window.innerHeight/2+"px"});t.observe(e),L(e,()=>{t.disconnect()})}})};var C=new Set;function _(e){let s=[];if(e)if(typeof e=="string"){let i="",n=e.split(", ");n.forEach((t,r)=>{t=t.trim(),r===n.length-1?i+=`${t}[aoife-next], ${t} [aoife-next]`:i+=`${t}[aoife-next], ${t} [aoife-next],`}),s=document.body.querySelectorAll(i)}else Object.prototype.toString.call(e)==="[object Array]"?(s=[...e],e.forEach(i=>{s.push(...i.querySelectorAll("*"))})):(s=[e],s.push(...e.querySelectorAll("*")));return s}var N=(e,s)=>{if(!e){console.error("aoife.next() need target");return}let i=_(s),n=_(e),t=n.length;for(let r=0;r<t;r++){let a=n[r];if(a.__next&&document.body.contains(a)){if(i.length){let o=i.length,l=!1;for(let c=0;c<o;c++){let u=i[c];if(u===a||u.contains(a)){l=!0;break}}if(l)continue}a.__next.forEach(o=>{o()})}}C.forEach(r=>r())},h=(e,s,i)=>{e.__next||(e.setAttribute("aoife-next",""),e.__next=new Map),e.__next.set(s,i)};var A={autofocus:!0,role:!0,viewBox:!0,flavor:!0};function M(e,s){return typeof s=="function"?Promise.resolve(s(e)):s}document.createElement;function v(e,s,i){let n=s,t=e,r=i[n];if(/^on/.test(n))return t[n]=r,null;if(/^listen/.test(n))return t.addEventListener(n.replace("listen",""),r),null;let a;return t.__isSvg||A[n]||/-/.test(n)?a=async()=>{let o=await M(t,r);t.getAttribute(n)!==o&&(o===!1?t.removeAttribute(n):t.setAttribute(n,o))}:n==="style"?a=async()=>{let o=await M(t,r);if(!!o){if(typeof o=="string"){t.style.cssText=o;return}Object.assign(t.style,o)}}:n==="className"?a=async()=>{let o=await M(t,r);typeof o!="string"&&(o=o.join(" ")),t.className!==o&&(t.className=o)}:a=async()=>{let o=await M(t,r);t[n]!==o&&(t[n]=o)},a(),typeof r!="function"?null:a}function b(e){let s=Object.prototype.toString.call(e);if(s==="[object String]"||s==="[object Number]")return!0}function x(e){return Object.prototype.toString.call(e).indexOf("lement")>0}var O=e=>{let s=[];return e.forEach(i=>{Array.isArray(i)?s=s.concat(i):s.push(i)}),s};function H(e,s){e.isEqualNode(s)||e.replaceWith(s)}function S(e,s){if(!Array.isArray(e))return;e.filter(n=>n!=null).forEach((n,t)=>{if(b(n)){let r=document.createTextNode(n);r.key=t,s.append(r)}else if(typeof n=="function"){let r=document.createTextNode("");s.append(r);let a=async()=>{let o=await Promise.resolve(n());if(b(o)){let l=document.createTextNode(o);l.key=t;let c=!1;return s.childNodes.forEach(u=>{if(u.key===l.key){if(u.textContent===l.textContent){c=!0;return}H(u,l),c=!0}}),c||s.insertBefore(l,r),t}else if(Array.isArray(o)){let l={},c={};o.forEach((f,p)=>{f.___forList=t,f.key||(f.key=`fn(${t})-list(${p})`),c[f.key]=f});let u=[];return s.childNodes.forEach(f=>{f.___forList===t&&(c[f.key]?l[f.key]=f:u.push(f))}),u.forEach(f=>{f.remove()}),o.forEach(f=>{let p=l[f.key];p?p.isEqualNode(f)||H(p,f):f!==!1&&s.insertBefore(f,r)}),"for-list-"+t}else if(o){o.key||(o.key=t);let l=!1;return s.childNodes.forEach(c=>{c.key===o.key&&(H(c,o),l=!0)}),l||s.insertBefore(o,r),o.key}};a(),h(s,"children",a)}else if(x(n))s.append(n);else if(n!==!1)if(Object.prototype.toString.call(n)==="[object Array]"){let r=[];for(let a=0;a<n.length;a++){let o=n[a];o!==!1&&r.push(o)}s.append(...r)}else s.appendChild(n)})}var w=[],j=e=>{w.push(e)};var F={svg:!0,rect:!0,circle:!0,ellipse:!0,line:!0,polyline:!0,polygon:!0,path:!0,animate:!0,animateColor:!0,animateMotion:!0,animateTransform:!0,clipPath:!0,"color-profile":!0,"definition-src":!0,defs:!0,desc:!0,filter:!0,font:!0,"font-face":!0,"font-face-format":!0,"font-face-name":!0,"font-face-src":!0,"font-face-uri":!0,g:!0,glyph:!0,hkern:!0,linearGradient:!0,marker:!0,mask:!0,view:!0};var W={class:1,className:1,onsubmit:1,onAppend:1,onRemove:1,onEntry:1,child:1,children:1,length:1},I=["className"],q="http://www.w3.org/2000/svg",y=(e,s,...i)=>{let n={};if(s&&(typeof s=="function"||b(s)||x(s)?i=[s,...i]:Array.isArray(s)?i=[...s,...i]:n=s),i=O(i),(!n.children||!n.children.length)&&(n.children=[...i]),n.class&&(n.className=n.class,delete n.class),Array.isArray(e))return y(...e);let t;if(typeof e=="function"){if(t=e(n),t&&typeof t.then=="function"){let r=document.createElement("span");return r.setAttribute("promise-span",""),t.then(a=>{r.replaceWith(a)}),r}return t}if(typeof e=="string")if(e==="template"&&n.children){let r="";n.children.forEach(a=>{(typeof a=="string"||typeof a=="number")&&(r+=a)}),t=document.createElement("template"),t.innerHTML=r}else F[e]?(t=document.createElementNS(q,e),t.__isSvg=!0):t=document.createElement(e);else x(e)&&(t=e);return n.onsubmit&&(t.onsubmit=r=>{r.preventDefault(),n.onsubmit&&n.onsubmit(r)}),I.forEach(r=>{if(n[r]){let a=v(t,r,n);a&&h(t,r,a)}}),Object.keys(n).forEach(r=>{if(W[r])return;let a=v(t,r,n);a&&h(t,r,a)}),S(n.children,t),typeof n.onAppend=="function"&&T(t,n.onAppend),typeof n.onRemove=="function"&&L(t,n.onRemove),typeof n.onEntry=="function"&&k(t,n.onEntry),w.length&&w.forEach(r=>{r(t,n)}),t},K=e=>e&&e.children?y("span",{style:{all:"unset"}},...e.children):"";y.jsxFrag=K;y.next=N;y.attributeKeys=A;y.subscrib=v;y.useMiddleware=j;window.aoife=y;export{y as aoife,K as jsxFrag};
